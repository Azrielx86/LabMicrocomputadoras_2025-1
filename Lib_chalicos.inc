
processor 16f877
include <p16f877.inc>
#DEFINE DEBUG

CONFIG_FLAG EQU 0X70
MOD_FLAG	EQU 0X71

valor1 equ h'21'
valor2 equ h'22'
valor3 equ h'23'

;Cargar los valores de configuracion antes de llamar a la subrutina
CONFIG_PORT:
	BSF     STATUS,RP0;
	BCF     STATUS, RP1

	BTFSS   CONFIG_FLAG,0
	GOTO    CPORTB
	
	MOVLW   0X00
	BTFSC   MOD_FLAG, 0
	MOVLW   0XFF	
	
	MOVWF   TRISA
CPORTB: 
	BTFSS   CONFIG_FLAG,1
	GOTO    CPORTC
	
	MOVLW   0X00
	BTFSC   MOD_FLAG, 1
	MOVLW   0XFF
	MOVWF   TRISB
CPORTC:
	BTFSS	CONFIG_FLAG,1
	GOTO CPORTD
	
	MOVLW 0X80
	BTFSC MOD_FLAG, 2
	MOVLW 0X8F	
	
	MOVWF TRISC

CPORTD:
	BTFSS	CONFIG_FLAG,1
	GOTO END_CONFIG
	
	MOVLW 0X80
	BTFSC MOD_FLAG, 2
	MOVLW 0X8F	
	
	MOVWF TRISD

END_CONFIG:
	CLRF PORTA
	CLRF PORTB
	CLRF PORTC
	CLRF PORTD
	BCF STATUS, RP0
	
	RETURN
	

ORG 0
GOTO INICIO
ORG 5

INICIO:
	CALL CONFIG_PUERTOS
IFDEF DEBUG

ENDIF

	GOTO INICIO

CONFIG_PUERTOS:
	BSF STATUS,RP0
	
	

retardo MOVLW cte1
MOVWF valor1
tres MOVLW cte2
MOVWF valor2
dos MOVLW cte3
MOVWF valor3
uno DECFSZ valor3
GOTO uno
DECFSZ valor2
GOTO dos
DECFSZ valor1
GOTO tres
RETURN

END
END