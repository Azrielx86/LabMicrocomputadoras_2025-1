processor 16f877
include <p16f877.inc>

SALIDA 	EQU 0x20
EDO1 	EQU 0x41
EDO2 	EQU 0x21
EDO3 	EQU 0x14
EDO4 	EQU 0x12

EDO1_Inv	EQU	0xBF

valor1 equ h'21'
valor2 equ h'22'
valor3 equ h'23'

BLINKS	equ	0x24
MASK	equ	0x25

cte1 equ 20h
cte2 equ 50h
cte3 equ 60h
	ORG 0
	GOTO INICIO
	ORG 5

INICIO:

	CALL CONFIG_INICIAL

LOOP:
	MOVLW EDO1
	MOVWF PORTB
	CALL RETARDO_2000ms 

	MOVLW 	0x03
	MOVWF	BLINKS
	MOVLW	0x01
	MOVWF	MASK
BLINK_S1:
	MOVLW	EDO1
	MOVWF	PORTB
	CALL RETARDO_500ms
	BCF		PORTB,6
	CALL RETARDO_500ms
	DECFSZ	BLINKS
	GOTO BLINK_S1

	MOVLW EDO2
	MOVWF PORTB
	CALL RETARDO_2000ms 

	MOVLW EDO3
	MOVWF PORTB
	CALL RETARDO_2000ms

	MOVLW 	0x03
	MOVWF	BLINKS
BLINK_S2:
	MOVLW	EDO3
	MOVWF	PORTB
	CALL RETARDO_500ms
	BCF		PORTB,2
	CALL RETARDO_500ms
	DECFSZ	BLINKS
	GOTO BLINK_S2

	MOVLW EDO4
	MOVWF PORTB
	CALL RETARDO_2000ms  
	GOTO LOOP

CONFIG_INICIAL:
	;Camio al banco 1
	BCF STATUS, RP1
	BSF STATUS, RP0
	
	CLRF TRISB ;configura los pines del puerto B como salida
	CLRF PORTB

	;Cambio al banco 0
	BCF STATUS, RP0
	RETURN

RETARDO_2000ms 
	MOVLW .200
	MOVWF valor1
tres:
	MOVLW .200
	MOVWF valor2
dos: 
	MOVLW .82
	MOVWF valor3
uno: 
	DECFSZ 	valor3
	GOTO 	uno
	DECFSZ 	valor2
	GOTO 	dos
	DECFSZ 	valor1
	GOTO 	tres
	RETURN

RETARDO_500ms 
	MOVLW .60
	MOVWF valor1
tres_500:
	MOVLW .200
	MOVWF valor2
dos_500: 
	MOVLW .82
	MOVWF valor3
uno_500: 
	DECFSZ 	valor3
	GOTO 	uno_500
	DECFSZ 	valor2
	GOTO 	dos_500
	DECFSZ 	valor1
	GOTO 	tres_500
	RETURN
END: